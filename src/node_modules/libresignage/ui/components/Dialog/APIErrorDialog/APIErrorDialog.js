var AlertDialog = require('libresignage/ui/components/Dialog/AlertDialog');
var APIError = require('libresignage/api/APIError');

/**
* A class representing an API error alert dialog.
*
* @memberof module:libresignage/ui/components/Dialog
*/
class APIErrorDialog extends AlertDialog {
	/**
	* Construct a new APIErrorDialog object,
	*
	* @param {APIError}            error    The error object to display.
	* @param {BaseDialog_Callback} callback A callback function.
	*/
	constructor(error, callback) {
		let msg = null;

		if (!(error instanceof APIError)) { throw error; }
		if (error.get_code() in APIError.messages) {
			msg = APIError.messages[error.get_code()];
			super(msg.short, msg.long + ` (${error.get_err_msg()})`, callback);
		} else {
			if (error.get_err_msg() != 'Unknown') {
				super("An error occured", error.get_err_msg(), callback);
			} else {
				super("Unknown error", "An unknown error occured.", callback);
			}
		}
		console.error(error.toString());
	}
}
module.exports = APIErrorDialog;
